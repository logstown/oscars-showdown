<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-item slot="start" *ngIf="currentUser">
      <ion-avatar>
        <img alt="Silhouette of a person's head" [src]="currentUser.photoURL || 'https://ionicframework.com/docs/img/demos/avatar.svg'"  />
      </ion-avatar>
    </ion-item>
    <ion-title>
      Ballot
    </ion-title>
    <ion-button *ngIf="currentUser" slot="end" (click)="logout()" fill="clear">Logout</ion-button>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Ballot</ion-title>
    </ion-toolbar>
  </ion-header>

  <app-welcome *ngIf="!currentUser"></app-welcome>
  
  <ion-list *ngIf="currentUser" style="margin-top: 20px;">
    <ion-item-group *ngFor="let award of awards$ | async; trackBy:identify">
      <ion-item-divider [color]="getAwardColor(award)" mode="ios">
        <ion-label>{{award.award}}</ion-label>
        <ion-note color="dark" slot="end">{{award.points}} point<span *ngIf="award.points > 1">s</span></ion-note>
      </ion-item-divider>
      <ion-radio-group [value]="currentUser.picks[award.id]?.id" (ionChange)="nomineePicked($event, award)">
        <ion-item *ngFor="let nominee of award.nominees">
          <ion-label class="ion-text-wrap">
            <h2 *ngIf="nominee.nominee">{{nominee.nominee}}</h2>
            <span *ngIf="!nominee.nominee">{{nominee.film}}</span>
            <p *ngIf="nominee.nominee">{{nominee.film}}</p>
          </ion-label>
          <ion-button *ngIf="appService.isAfterCeremonyStart && currentUser.uid == 'eKIs8Uh8c4hR6B9ZSPg6cRNh4h82'" (click)="setWinner(award, nominee)">winner</ion-button>
          <ion-icon *ngIf="appService.isAfterCeremonyStart && nominee.id == award.winner" color="warning" name="trophy"></ion-icon>
          <ion-radio slot="end" [value]="nominee.id" [disabled]="appService.isAfterCeremonyStart"></ion-radio>
        </ion-item>
      </ion-radio-group>
    </ion-item-group>
  </ion-list>
</ion-content>
